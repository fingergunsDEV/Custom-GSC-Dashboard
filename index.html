<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6750A4',
                        secondary: '#958DA5',
                        tertiary: '#B58392',
                        surface: '#FEF7FF',
                        background: '#FFFBFE',
                        error: '#B3261E',
                    },
                    fontFamily: {
                        'roboto': ['Roboto', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #FFFBFE;
            color: #1C1B1F;
        }
        
        .material-card {
            border-radius: 16px;
            background-color: #FEF7FF;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        }
        
        .material-btn {
            border-radius: 100px;
            font-weight: 500;
            text-transform: capitalize;
            transition: all 0.3s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        }
        
        .material-btn:hover {
            box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
        }
        
        .material-btn:active {
            box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        }
        
        .material-icon {
            font-family: 'Material Icons';
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            -webkit-font-feature-settings: 'liga';
            -webkit-font-smoothing: antialiased;
        }
        
        .chart-container {
            height: 300px;
            position: relative;
        }
        
        .nav-item {
            transition: background-color 0.3s;
            border-radius: 100px;
        }
        
        .nav-item:hover {
            background-color: rgba(103, 80, 164, 0.08);
        }
        
        .nav-item.active {
            background-color: rgba(103, 80, 164, 0.12);
            color: #6750A4;
        }
        
        .chip {
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .chip.active {
            background-color: #6750A4;
            color: white;
        }
        
        .chip:hover:not(.active) {
            background-color: rgba(103, 80, 164, 0.08);
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 32px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #E7E0EC;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 24px;
            width: 24px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #6750A4;
        }
        
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #FEF7FF;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .dropdown-content a {
            color: #1C1B1F;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        
        .dropdown-content a:hover {
            background-color: rgba(103, 80, 164, 0.08);
        }
        
        .show {
            display: block;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #F5F5F5;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #BDBDBD;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #9E9E9E;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- Top App Bar -->
    <header class="bg-surface shadow-sm z-10">
        <div class="container mx-auto px-4 py-2 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <button id="menuBtn" class="p-2 rounded-full hover:bg-gray-200">
                    <span class="material-icon">menu</span>
                </button>
                <h1 class="text-xl font-medium">Analytics Dashboard</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button id="exportPdfBtn" class="material-btn bg-primary text-white px-4 py-2 flex items-center">
                    <span class="material-icon mr-1">picture_as_pdf</span>
                    Export PDF
                </button>
                <div class="dropdown">
                    <button id="accountDropdown" class="p-2 rounded-full hover:bg-gray-200">
                        <span class="material-icon">account_circle</span>
                    </button>
                    <div id="accountDropdownContent" class="dropdown-content right-0">
                        <a href="#" class="flex items-center">
                            <span class="material-icon mr-2">settings</span>
                            Settings
                        </a>
                        <a href="#" class="flex items-center">
                            <span class="material-icon mr-2">help</span>
                            Help
                        </a>
                        <a href="#" class="flex items-center">
                            <span class="material-icon mr-2">logout</span>
                            Logout
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex flex-1">
        <!-- Side Navigation -->
        <aside id="sideNav" class="w-64 bg-surface border-r border-gray-200 h-screen transition-all duration-300">
            <div class="p-4">
                <div class="material-card p-4 mb-6">
                    <h2 class="font-medium mb-2">Connected Accounts</h2>
                    <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center">
                            <span class="material-icon mr-2 text-green-500">check_circle</span>
                            <span>Search Console</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="material-icon mr-2 text-green-500">check_circle</span>
                            <span>Analytics</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <h3 class="text-sm font-medium text-gray-500 mb-2">NAVIGATION</h3>
                <nav>
                    <ul>
                        <li>
                            <a href="#dashboard" class="nav-item active flex items-center px-4 py-2 mb-1">
                                <span class="material-icon mr-3">dashboard</span>
                                Dashboard
                            </a>
                        </li>
                        <li>
                            <a href="#search-console" class="nav-item flex items-center px-4 py-2 mb-1">
                                <span class="material-icon mr-3">search</span>
                                Search Console
                            </a>
                        </li>
                        <li>
                            <a href="#analytics" class="nav-item flex items-center px-4 py-2 mb-1">
                                <span class="material-icon mr-3">analytics</span>
                                Analytics
                            </a>
                        </li>
                        <li>
                            <a href="#custom-reports" class="nav-item flex items-center px-4 py-2 mb-1">
                                <span class="material-icon mr-3">bar_chart</span>
                                Custom Reports
                            </a>
                        </li>
                        <li>
                            <a href="#settings" class="nav-item flex items-center px-4 py-2 mb-1">
                                <span class="material-icon mr-3">settings</span>
                                Settings
                            </a>
                        </li>
                    </ul>
                </nav>
                
                <div class="mt-8">
                    <h3 class="text-sm font-medium text-gray-500 mb-2">GOOGLE SHEET</h3>
                    <div class="material-card p-4">
                        <div class="flex items-center mb-2">
                            <span class="material-icon mr-2 text-green-500">description</span>
                            <span class="text-sm">Analytics-Data.xlsx</span>
                        </div>
                        <button id="connectSheetBtn" class="material-btn bg-primary text-white px-4 py-2 w-full flex items-center justify-center">
                            <span class="material-icon mr-1">link</span>
                            Connect Sheet
                        </button>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 p-6 overflow-auto">
            <!-- Dashboard Tab -->
            <section id="dashboard" class="tab-content">
                <div class="mb-6">
                    <h2 class="text-2xl font-medium mb-2">Dashboard Overview</h2>
                    <p class="text-gray-600">Connected to Google Search Console and Analytics</p>
                </div>
                
                <!-- Date Range Selector -->
                <div class="material-card p-4 mb-6">
                    <div class="flex flex-wrap items-center justify-between">
                        <div class="flex items-center space-x-2 mb-2 sm:mb-0">
                            <span class="material-icon text-primary">date_range</span>
                            <span class="font-medium">Date Range:</span>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <button class="chip active">Last 7 days</button>
                            <button class="chip">Last 30 days</button>
                            <button class="chip">Last 3 months</button>
                            <button class="chip">Last year</button>
                            <button class="chip flex items-center">
                                <span class="material-icon mr-1">calendar_today</span>
                                Custom
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Stats -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Total Users</span>
                            <span class="material-icon text-primary">person</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">24,521</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_upward</span>
                                12.5%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Page Views</span>
                            <span class="material-icon text-primary">visibility</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">78,623</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_upward</span>
                                8.2%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Avg. Session</span>
                            <span class="material-icon text-primary">timer</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">2:34</span>
                            <span class="ml-2 text-red-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_downward</span>
                                3.1%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Bounce Rate</span>
                            <span class="material-icon text-primary">exit_to_app</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">42.8%</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_downward</span>
                                5.7%
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Charts Section -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Traffic Overview Chart -->
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-medium">Traffic Overview</h3>
                            <div class="dropdown">
                                <button class="p-1 rounded hover:bg-gray-200">
                                    <span class="material-icon">more_vert</span>
                                </button>
                                <div class="dropdown-content right-0">
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">download</span>
                                        Download
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">edit</span>
                                        Edit
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">delete</span>
                                        Remove
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="100%" height="100%" viewBox="0 0 800 300">
                                <!-- Grid Lines -->
                                <line x1="50" y1="250" x2="750" y2="250" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="200" x2="750" y2="200" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="150" x2="750" y2="150" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="100" x2="750" y2="100" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="50" x2="750" y2="50" stroke="#E0E0E0" stroke-width="1" />
                                
                                <!-- Y-axis labels -->
                                <text x="40" y="250" text-anchor="end" font-size="12" fill="#757575">0</text>
                                <text x="40" y="200" text-anchor="end" font-size="12" fill="#757575">5k</text>
                                <text x="40" y="150" text-anchor="end" font-size="12" fill="#757575">10k</text>
                                <text x="40" y="100" text-anchor="end" font-size="12" fill="#757575">15k</text>
                                <text x="40" y="50" text-anchor="end" font-size="12" fill="#757575">20k</text>
                                
                                <!-- X-axis labels -->
                                <text x="100" y="270" text-anchor="middle" font-size="12" fill="#757575">Mon</text>
                                <text x="200" y="270" text-anchor="middle" font-size="12" fill="#757575">Tue</text>
                                <text x="300" y="270" text-anchor="middle" font-size="12" fill="#757575">Wed</text>
                                <text x="400" y="270" text-anchor="middle" font-size="12" fill="#757575">Thu</text>
                                <text x="500" y="270" text-anchor="middle" font-size="12" fill="#757575">Fri</text>
                                <text x="600" y="270" text-anchor="middle" font-size="12" fill="#757575">Sat</text>
                                <text x="700" y="270" text-anchor="middle" font-size="12" fill="#757575">Sun</text>
                                
                                <!-- Line for Users -->
                                <path d="M100,180 L200,150 L300,120 L400,140 L500,100 L600,130 L700,90" 
                                      fill="none" stroke="#6750A4" stroke-width="3" />
                                
                                <!-- Line for Page Views -->
                                <path d="M100,200 L200,170 L300,140 L400,160 L500,120 L600,150 L700,110" 
                                      fill="none" stroke="#B58392" stroke-width="3" />
                                
                                <!-- Data points for Users -->
                                <circle cx="100" cy="180" r="5" fill="#6750A4" />
                                <circle cx="200" cy="150" r="5" fill="#6750A4" />
                                <circle cx="300" cy="120" r="5" fill="#6750A4" />
                                <circle cx="400" cy="140" r="5" fill="#6750A4" />
                                <circle cx="500" cy="100" r="5" fill="#6750A4" />
                                <circle cx="600" cy="130" r="5" fill="#6750A4" />
                                <circle cx="700" cy="90" r="5" fill="#6750A4" />
                                
                                <!-- Data points for Page Views -->
                                <circle cx="100" cy="200" r="5" fill="#B58392" />
                                <circle cx="200" cy="170" r="5" fill="#B58392" />
                                <circle cx="300" cy="140" r="5" fill="#B58392" />
                                <circle cx="400" cy="160" r="5" fill="#B58392" />
                                <circle cx="500" cy="120" r="5" fill="#B58392" />
                                <circle cx="600" cy="150" r="5" fill="#B58392" />
                                <circle cx="700" cy="110" r="5" fill="#B58392" />
                            </svg>
                        </div>
                        <div class="flex justify-center mt-2">
                            <div class="flex items-center mr-4">
                                <div class="w-3 h-3 rounded-full bg-primary mr-1"></div>
                                <span class="text-sm">Users</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-3 h-3 rounded-full bg-tertiary mr-1"></div>
                                <span class="text-sm">Page Views</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Top Pages Chart -->
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-medium">Top Pages</h3>
                            <div class="dropdown">
                                <button class="p-1 rounded hover:bg-gray-200">
                                    <span class="material-icon">more_vert</span>
                                </button>
                                <div class="dropdown-content right-0">
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">download</span>
                                        Download
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">edit</span>
                                        Edit
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">delete</span>
                                        Remove
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="100%" height="100%" viewBox="0 0 800 300">
                                <!-- Horizontal bars -->
                                <rect x="150" y="40" width="500" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="80" width="420" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="120" width="380" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="160" width="320" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="200" width="280" height="30" fill="#6750A4" rx="4" ry="4" />
                                
                                <!-- Labels -->
                                <text x="140" y="60" text-anchor="end" font-size="12" fill="#757575">/home</text>
                                <text x="140" y="100" text-anchor="end" font-size="12" fill="#757575">/products</text>
                                <text x="140" y="140" text-anchor="end" font-size="12" fill="#757575">/blog</text>
                                <text x="140" y="180" text-anchor="end" font-size="12" fill="#757575">/about</text>
                                <text x="140" y="220" text-anchor="end" font-size="12" fill="#757575">/contact</text>
                                
                                <!-- Values -->
                                <text x="660" y="60" font-size="12" fill="#FFFFFF" font-weight="bold">25,430</text>
                                <text x="580" y="100" font-size="12" fill="#FFFFFF" font-weight="bold">21,285</text>
                                <text x="540" y="140" font-size="12" fill="#FFFFFF" font-weight="bold">19,362</text>
                                <text x="480" y="180" font-size="12" fill="#FFFFFF" font-weight="bold">16,758</text>
                                <text x="440" y="220" font-size="12" fill="#FFFFFF" font-weight="bold">14,321</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- Search Console Data -->
                <div class="material-card p-4 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium">Search Console Performance</h3>
                        <button id="addToReportBtn" class="material-btn bg-white border border-gray-300 text-gray-700 px-4 py-2 flex items-center">
                            <span class="material-icon mr-1">add_chart</span>
                            Add to Report
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Query</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Clicks</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Impressions</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">CTR</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Position</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">digital marketing services</td>
                                    <td class="py-3 px-4">1,245</td>
                                    <td class="py-3 px-4">15,678</td>
                                    <td class="py-3 px-4">7.9%</td>
                                    <td class="py-3 px-4">3.2</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">seo agency near me</td>
                                    <td class="py-3 px-4">987</td>
                                    <td class="py-3 px-4">12,453</td>
                                    <td class="py-3 px-4">7.9%</td>
                                    <td class="py-3 px-4">4.1</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">best marketing company</td>
                                    <td class="py-3 px-4">854</td>
                                    <td class="py-3 px-4">10,234</td>
                                    <td class="py-3 px-4">8.3%</td>
                                    <td class="py-3 px-4">5.7</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">social media marketing</td>
                                    <td class="py-3 px-4">743</td>
                                    <td class="py-3 px-4">9,876</td>
                                    <td class="py-3 px-4">7.5%</td>
                                    <td class="py-3 px-4">6.2</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4">content marketing strategy</td>
                                    <td class="py-3 px-4">621</td>
                                    <td class="py-3 px-4">8,543</td>
                                    <td class="py-3 px-4">7.3%</td>
                                    <td class="py-3 px-4">7.8</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Custom Report Builder -->
                <div class="material-card p-4">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium">Custom Report Builder</h3>
                        <button id="saveReportBtn" class="material-btn bg-primary text-white px-4 py-2 flex items-center">
                            <span class="material-icon mr-1">save</span>
                            Save Report
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-sm font-medium text-gray-500 mb-2">AVAILABLE CHARTS</h4>
                            <div id="availableCharts" class="border border-gray-200 rounded-lg p-4 h-64 overflow-y-auto">
                                <div class="chart-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">insert_chart</span>
                                        <span>Traffic Overview</span>
                                    </div>
                                    <span class="material-icon add-chart">add_circle</span>
                                </div>
                                <div class="chart-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">bar_chart</span>
                                        <span>Top Pages</span>
                                    </div>
                                    <span class="material-icon add-chart">add_circle</span>
                                </div>
                                <div class="chart-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">pie_chart</span>
                                        <span>Traffic Sources</span>
                                    </div>
                                    <span class="material-icon add-chart">add_circle</span>
                                </div>
                                <div class="chart-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">trending_up</span>
                                        <span>Keyword Rankings</span>
                                    </div>
                                    <span class="material-icon add-chart">add_circle</span>
                                </div>
                                <div class="chart-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">public</span>
                                        <span>Geographic Distribution</span>
                                    </div>
                                    <span class="material-icon add-chart">add_circle</span>
                                </div>
                                <div class="chart-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">devices</span>
                                        <span>Device Breakdown</span>
                                    </div>
                                    <span class="material-icon add-chart">add_circle</span>
                                </div>
                                <div class="chart-item flex items-center justify-between p-2 hover:bg-gray-50 cursor-pointer">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">speed</span>
                                        <span>Page Speed Insights</span>
                                    </div>
                                    <span class="material-icon add-chart">add_circle</span>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="text-sm font-medium text-gray-500 mb-2">YOUR REPORT</h4>
                            <div id="yourReport" class="border border-gray-200 rounded-lg p-4 h-64 overflow-y-auto">
                                <div class="report-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">insert_chart</span>
                                        <span>Traffic Overview</span>
                                    </div>
                                    <div class="flex">
                                        <button class="move-up p-1 rounded hover:bg-gray-200 mr-1">
                                            <span class="material-icon">arrow_upward</span>
                                        </button>
                                        <button class="move-down p-1 rounded hover:bg-gray-200 mr-1">
                                            <span class="material-icon">arrow_downward</span>
                                        </button>
                                        <button class="delete-chart p-1 rounded hover:bg-gray-200">
                                            <span class="material-icon">delete</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="report-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">bar_chart</span>
                                        <span>Top Pages</span>
                                    </div>
                                    <div class="flex">
                                        <button class="move-up p-1 rounded hover:bg-gray-200 mr-1">
                                            <span class="material-icon">arrow_upward</span>
                                        </button>
                                        <button class="move-down p-1 rounded hover:bg-gray-200 mr-1">
                                            <span class="material-icon">arrow_downward</span>
                                        </button>
                                        <button class="delete-chart p-1 rounded hover:bg-gray-200">
                                            <span class="material-icon">delete</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="report-item flex items-center justify-between p-2 hover:bg-gray-50">
                                    <div class="flex items-center">
                                        <span class="material-icon text-primary mr-2">trending_up</span>
                                        <span>Keyword Rankings</span>
                                    </div>
                                    <div class="flex">
                                        <button class="move-up p-1 rounded hover:bg-gray-200 mr-1">
                                            <span class="material-icon">arrow_upward</span>
                                        </button>
                                        <button class="move-down p-1 rounded hover:bg-gray-200 mr-1">
                                            <span class="material-icon">arrow_downward</span>
                                        </button>
                                        <button class="delete-chart p-1 rounded hover:bg-gray-200">
                                            <span class="material-icon">delete</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4">
                                <button id="previewReportBtn" class="material-btn bg-white border border-gray-300 text-gray-700 px-4 py-2 flex items-center mr-2">
                                    <span class="material-icon mr-1">visibility</span>
                                    Preview
                                </button>
                                <button id="exportReportBtn" class="material-btn bg-primary text-white px-4 py-2 flex items-center">
                                    <span class="material-icon mr-1">picture_as_pdf</span>
                                    Export PDF
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Search Console Tab -->
            <section id="search-console" class="tab-content hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-medium mb-2">Search Console</h2>
                    <p class="text-gray-600">Performance metrics from Google Search Console</p>
                </div>
                
                <!-- Date Range Selector -->
                <div class="material-card p-4 mb-6">
                    <div class="flex flex-wrap items-center justify-between">
                        <div class="flex items-center space-x-2 mb-2 sm:mb-0">
                            <span class="material-icon text-primary">date_range</span>
                            <span class="font-medium">Date Range:</span>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <button class="chip active">Last 7 days</button>
                            <button class="chip">Last 30 days</button>
                            <button class="chip">Last 3 months</button>
                            <button class="chip">Last year</button>
                            <button class="chip flex items-center">
                                <span class="material-icon mr-1">calendar_today</span>
                                Custom
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Stats for Search Console -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Total Clicks</span>
                            <span class="material-icon text-primary">mouse</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">5,450</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_upward</span>
                                15.3%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Total Impressions</span>
                            <span class="material-icon text-primary">visibility</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">120,340</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_upward</span>
                                10.1%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Avg. CTR</span>
                            <span class="material-icon text-primary">percent</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">4.5%</span>
                            <span class="ml-2 text-red-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_downward</span>
                                0.5%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Avg. Position</span>
                            <span class="material-icon text-primary">leaderboard</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">5.8</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_downward</span>
                                1.2
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Charts Section for Search Console -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Clicks and Impressions Chart -->
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-medium">Clicks and Impressions</h3>
                            <div class="dropdown">
                                <button class="p-1 rounded hover:bg-gray-200">
                                    <span class="material-icon">more_vert</span>
                                </button>
                                <div class="dropdown-content right-0">
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">download</span>
                                        Download
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">edit</span>
                                        Edit
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">delete</span>
                                        Remove
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="100%" height="100%" viewBox="0 0 800 300">
                                <!-- Grid Lines -->
                                <line x1="50" y1="250" x2="750" y2="250" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="200" x2="750" y2="200" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="150" x2="750" y2="150" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="100" x2="750" y2="100" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="50" x2="750" y2="50" stroke="#E0E0E0" stroke-width="1" />
                                
                                <!-- Y-axis labels -->
                                <text x="40" y="250" text-anchor="end" font-size="12" fill="#757575">0</text>
                                <text x="40" y="200" text-anchor="end" font-size="12" fill="#757575">20k</text>
                                <text x="40" y="150" text-anchor="end" font-size="12" fill="#757575">40k</text>
                                <text x="40" y="100" text-anchor="end" font-size="12" fill="#757575">60k</text>
                                <text x="40" y="50" text-anchor="end" font-size="12" fill="#757575">80k</text>
                                
                                <!-- X-axis labels -->
                                <text x="100" y="270" text-anchor="middle" font-size="12" fill="#757575">Mon</text>
                                <text x="200" y="270" text-anchor="middle" font-size="12" fill="#757575">Tue</text>
                                <text x="300" y="270" text-anchor="middle" font-size="12" fill="#757575">Wed</text>
                                <text x="400" y="270" text-anchor="middle" font-size="12" fill="#757575">Thu</text>
                                <text x="500" y="270" text-anchor="middle" font-size="12" fill="#757575">Fri</text>
                                <text x="600" y="270" text-anchor="middle" font-size="12" fill="#757575">Sat</text>
                                <text x="700" y="270" text-anchor="middle" font-size="12" fill="#757575">Sun</text>
                                
                                <!-- Line for Clicks -->
                                <path d="M100,200 L200,180 L300,160 L400,140 L500,120 L600,100 L700,80" 
                                      fill="none" stroke="#6750A4" stroke-width="3" />
                                
                                <!-- Line for Impressions -->
                                <path d="M100,50 L200,60 L300,70 L400,80 L500,90 L600,100 L700,110" 
                                      fill="none" stroke="#B58392" stroke-width="3" />
                                
                                <!-- Data points for Clicks -->
                                <circle cx="100" cy="200" r="5" fill="#6750A4" />
                                <circle cx="200" cy="180" r="5" fill="#6750A4" />
                                <circle cx="300" cy="160" r="5" fill="#6750A4" />
                                <circle cx="400" cy="140" r="5" fill="#6750A4" />
                                <circle cx="500" cy="120" r="5" fill="#6750A4" />
                                <circle cx="600" cy="100" r="5" fill="#6750A4" />
                                <circle cx="700" cy="80" r="5" fill="#6750A4" />
                                
                                <!-- Data points for Impressions -->
                                <circle cx="100" cy="50" r="5" fill="#B58392" />
                                <circle cx="200" cy="60" r="5" fill="#B58392" />
                                <circle cx="300" cy="70" r="5" fill="#B58392" />
                                <circle cx="400" cy="80" r="5" fill="#B58392" />
                                <circle cx="500" cy="90" r="5" fill="#B58392" />
                                <circle cx="600" cy="100" r="5" fill="#B58392" />
                                <circle cx="700" cy="110" r="5" fill="#B58392" />
                            </svg>
                        </div>
                        <div class="flex justify-center mt-2">
                            <div class="flex items-center mr-4">
                                <div class="w-3 h-3 rounded-full bg-primary mr-1"></div>
                                <span class="text-sm">Clicks</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-3 h-3 rounded-full bg-tertiary mr-1"></div>
                                <span class="text-sm">Impressions</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Top Queries Bar Chart -->
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-medium">Top Queries</h3>
                            <div class="dropdown">
                                <button class="p-1 rounded hover:bg-gray-200">
                                    <span class="material-icon">more_vert</span>
                                </button>
                                <div class="dropdown-content right-0">
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">download</span>
                                        Download
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">edit</span>
                                        Edit
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">delete</span>
                                        Remove
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="100%" height="100%" viewBox="0 0 800 300">
                                <!-- Horizontal bars -->
                                <rect x="150" y="40" width="500" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="80" width="450" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="120" width="400" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="160" width="350" height="30" fill="#6750A4" rx="4" ry="4" />
                                <rect x="150" y="200" width="300" height="30" fill="#6750A4" rx="4" ry="4" />
                                
                                <!-- Labels -->
                                <text x="140" y="60" text-anchor="end" font-size="12" fill="#757575">seo services</text>
                                <text x="140" y="100" text-anchor="end" font-size="12" fill="#757575">digital marketing</text>
                                <text x="140" y="140" text-anchor="end" font-size="12" fill="#757575">content strategy</text>
                                <text x="140" y="180" text-anchor="end" font-size="12" fill="#757575">social media</text>
                                <text x="140" y="220" text-anchor="end" font-size="12" fill="#757575">ppc ads</text>
                                
                                <!-- Values -->
                                <text x="660" y="60" font-size="12" fill="#FFFFFF" font-weight="bold">1,245</text>
                                <text x="610" y="100" font-size="12" fill="#FFFFFF" font-weight="bold">987</text>
                                <text x="560" y="140" font-size="12" fill="#FFFFFF" font-weight="bold">854</text>
                                <text x="510" y="180" font-size="12" fill="#FFFFFF" font-weight="bold">743</text>
                                <text x="460" y="220" font-size="12" fill="#FFFFFF" font-weight="bold">621</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- Detailed Query Table -->
                <div class="material-card p-4 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium">Detailed Query Performance</h3>
                        <button class="material-btn bg-white border border-gray-300 text-gray-700 px-4 py-2 flex items-center">
                            <span class="material-icon mr-1">add_chart</span>
                            Add to Report
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Query</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Clicks</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Impressions</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">CTR</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Position</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Pages</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">seo services</td>
                                    <td class="py-3 px-4">1,245</td>
                                    <td class="py-3 px-4">15,678</td>
                                    <td class="py-3 px-4">7.9%</td>
                                    <td class="py-3 px-4">3.2</td>
                                    <td class="py-3 px-4">/seo-services</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">digital marketing</td>
                                    <td class="py-3 px-4">987</td>
                                    <td class="py-3 px-4">12,453</td>
                                    <td class="py-3 px-4">7.9%</td>
                                    <td class="py-3 px-4">4.1</td>
                                    <td class="py-3 px-4">/digital-marketing</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">content strategy</td>
                                    <td class="py-3 px-4">854</td>
                                    <td class="py-3 px-4">10,234</td>
                                    <td class="py-3 px-4">8.3%</td>
                                    <td class="py-3 px-4">5.7</td>
                                    <td class="py-3 px-4">/blog/content-strategy</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">social media</td>
                                    <td class="py-3 px-4">743</td>
                                    <td class="py-3 px-4">9,876</td>
                                    <td class="py-3 px-4">7.5%</td>
                                    <td class="py-3 px-4">6.2</td>
                                    <td class="py-3 px-4">/social-media-marketing</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">ppc ads</td>
                                    <td class="py-3 px-4">621</td>
                                    <td class="py-3 px-4">8,543</td>
                                    <td class="py-3 px-4">7.3%</td>
                                    <td class="py-3 px-4">7.8</td>
                                    <td class="py-3 px-4">/ppc-services</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">email campaigns</td>
                                    <td class="py-3 px-4">512</td>
                                    <td class="py-3 px-4">7,892</td>
                                    <td class="py-3 px-4">6.5%</td>
                                    <td class="py-3 px-4">8.4</td>
                                    <td class="py-3 px-4">/email-marketing</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4">local seo</td>
                                    <td class="py-3 px-4">456</td>
                                    <td class="py-3 px-4">6,789</td>
                                    <td class="py-3 px-4">6.7%</td>
                                    <td class="py-3 px-4">9.1</td>
                                    <td class="py-3 px-4">/local-seo</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Analytics Tab -->
            <section id="analytics" class="tab-content hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-medium mb-2">Analytics</h2>
                    <p class="text-gray-600">User behavior and traffic sources from Google Analytics</p>
                </div>
                
                <!-- Date Range Selector -->
                <div class="material-card p-4 mb-6">
                    <div class="flex flex-wrap items-center justify-between">
                        <div class="flex items-center space-x-2 mb-2 sm:mb-0">
                            <span class="material-icon text-primary">date_range</span>
                            <span class="font-medium">Date Range:</span>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <button class="chip active">Last 7 days</button>
                            <button class="chip">Last 30 days</button>
                            <button class="chip">Last 3 months</button>
                            <button class="chip">Last year</button>
                            <button class="chip flex items-center">
                                <span class="material-icon mr-1">calendar_today</span>
                                Custom
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Stats for Analytics -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Active Users</span>
                            <span class="material-icon text-primary">group</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">3,210</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_upward</span>
                                8.7%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Sessions</span>
                            <span class="material-icon text-primary">access_time</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">45,678</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_upward</span>
                                5.4%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">Conversion Rate</span>
                            <span class="material-icon text-primary">trending_up</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">2.8%</span>
                            <span class="ml-2 text-red-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_downward</span>
                                0.2%
                            </span>
                        </div>
                    </div>
                    
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray-600">New Users</span>
                            <span class="material-icon text-primary">person_add</span>
                        </div>
                        <div class="flex items-end">
                            <span class="text-2xl font-medium">12,345</span>
                            <span class="ml-2 text-green-500 text-sm flex items-center">
                                <span class="material-icon text-sm">arrow_upward</span>
                                11.9%
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Charts Section for Analytics -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Users and Sessions Chart -->
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-medium">Users and Sessions</h3>
                            <div class="dropdown">
                                <button class="p-1 rounded hover:bg-gray-200">
                                    <span class="material-icon">more_vert</span>
                                </button>
                                <div class="dropdown-content right-0">
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">download</span>
                                        Download
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">edit</span>
                                        Edit
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">delete</span>
                                        Remove
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="100%" height="100%" viewBox="0 0 800 300">
                                <!-- Grid Lines -->
                                <line x1="50" y1="250" x2="750" y2="250" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="200" x2="750" y2="200" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="150" x2="750" y2="150" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="100" x2="750" y2="100" stroke="#E0E0E0" stroke-width="1" />
                                <line x1="50" y1="50" x2="750" y2="50" stroke="#E0E0E0" stroke-width="1" />
                                
                                <!-- Y-axis labels -->
                                <text x="40" y="250" text-anchor="end" font-size="12" fill="#757575">0</text>
                                <text x="40" y="200" text-anchor="end" font-size="12" fill="#757575">5k</text>
                                <text x="40" y="150" text-anchor="end" font-size="12" fill="#757575">10k</text>
                                <text x="40" y="100" text-anchor="end" font-size="12" fill="#757575">15k</text>
                                <text x="40" y="50" text-anchor="end" font-size="12" fill="#757575">20k</text>
                                
                                <!-- X-axis labels -->
                                <text x="100" y="270" text-anchor="middle" font-size="12" fill="#757575">Mon</text>
                                <text x="200" y="270" text-anchor="middle" font-size="12" fill="#757575">Tue</text>
                                <text x="300" y="270" text-anchor="middle" font-size="12" fill="#757575">Wed</text>
                                <text x="400" y="270" text-anchor="middle" font-size="12" fill="#757575">Thu</text>
                                <text x="500" y="270" text-anchor="middle" font-size="12" fill="#757575">Fri</text>
                                <text x="600" y="270" text-anchor="middle" font-size="12" fill="#757575">Sat</text>
                                <text x="700" y="270" text-anchor="middle" font-size="12" fill="#757575">Sun</text>
                                
                                <!-- Line for Users -->
                                <path d="M100,150 L200,130 L300,110 L400,90 L500,70 L600,50 L700,30" 
                                      fill="none" stroke="#6750A4" stroke-width="3" />
                                
                                <!-- Line for Sessions -->
                                <path d="M100,180 L200,160 L300,140 L400,120 L500,100 L600,80 L700,60" 
                                      fill="none" stroke="#B58392" stroke-width="3" />
                                
                                <!-- Data points for Users -->
                                <circle cx="100" cy="150" r="5" fill="#6750A4" />
                                <circle cx="200" cy="130" r="5" fill="#6750A4" />
                                <circle cx="300" cy="110" r="5" fill="#6750A4" />
                                <circle cx="400" cy="90" r="5" fill="#6750A4" />
                                <circle cx="500" cy="70" r="5" fill="#6750A4" />
                                <circle cx="600" cy="50" r="5" fill="#6750A4" />
                                <circle cx="700" cy="30" r="5" fill="#6750A4" />
                                
                                <!-- Data points for Sessions -->
                                <circle cx="100" cy="180" r="5" fill="#B58392" />
                                <circle cx="200" cy="160" r="5" fill="#B58392" />
                                <circle cx="300" cy="140" r="5" fill="#B58392" />
                                <circle cx="400" cy="120" r="5" fill="#B58392" />
                                <circle cx="500" cy="100" r="5" fill="#B58392" />
                                <circle cx="600" cy="80" r="5" fill="#B58392" />
                                <circle cx="700" cy="60" r="5" fill="#B58392" />
                            </svg>
                        </div>
                        <div class="flex justify-center mt-2">
                            <div class="flex items-center mr-4">
                                <div class="w-3 h-3 rounded-full bg-primary mr-1"></div>
                                <span class="text-sm">Users</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-3 h-3 rounded-full bg-tertiary mr-1"></div>
                                <span class="text-sm">Sessions</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Traffic Sources Pie Chart (Simulated with SVG) -->
                    <div class="material-card p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-medium">Traffic Sources</h3>
                            <div class="dropdown">
                                <button class="p-1 rounded hover:bg-gray-200">
                                    <span class="material-icon">more_vert</span>
                                </button>
                                <div class="dropdown-content right-0">
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">download</span>
                                        Download
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">edit</span>
                                        Edit
                                    </a>
                                    <a href="#" class="flex items-center">
                                        <span class="material-icon mr-2">delete</span>
                                        Remove
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="100%" height="100%" viewBox="0 0 400 300">
                                <!-- Pie slices -->
                                <path d="M200 150 L200 50 A100 100 0 0 1 300 150 Z" fill="#6750A4" />
                                <path d="M200 150 L300 150 A100 100 0 0 1 200 250 Z" fill="#B58392" />
                                <path d="M200 150 L200 250 A100 100 0 0 1 100 150 Z" fill="#958DA5" />
                                <path d="M200 150 L100 150 A100 100 0 0 1 200 50 Z" fill="#34D399" />
                                
                                <!-- Labels -->
                                <text x="280" y="100" font-size="12" fill="#757575">Organic 45%</text>
                                <text x="280" y="200" font-size="12" fill="#757575">Direct 25%</text>
                                <text x="50" y="200" font-size="12" fill="#757575">Referral 20%</text>
                                <text x="50" y="100" font-size="12" fill="#757575">Social 10%</text>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- User Behavior Table -->
                <div class="material-card p-4 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium">User Behavior</h3>
                        <button class="material-btn bg-white border border-gray-300 text-gray-700 px-4 py-2 flex items-center">
                            <span class="material-icon mr-1">add_chart</span>
                            Add to Report
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Page Path</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Users</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Sessions</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Avg. Time</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Bounce Rate</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">/home</td>
                                    <td class="py-3 px-4">10,234</td>
                                    <td class="py-3 px-4">12,345</td>
                                    <td class="py-3 px-4">3:45</td>
                                    <td class="py-3 px-4">35.2%</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">/products</td>
                                    <td class="py-3 px-4">8,765</td>
                                    <td class="py-3 px-4">9,876</td>
                                    <td class="py-3 px-4">2:56</td>
                                    <td class="py-3 px-4">42.1%</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">/blog</td>
                                    <td class="py-3 px-4">7,654</td>
                                    <td class="py-3 px-4">8,543</td>
                                    <td class="py-3 px-4">4:12</td>
                                    <td class="py-3 px-4">28.7%</td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">/about</td>
                                    <td class="py-3 px-4">6,543</td>
                                    <td class="py-3 px-4">7,432</td>
                                    <td class="py-3 px-4">1:45</td>
                                    <td class="py-3 px-4">50.3%</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-3 px-4">/contact</td>
                                    <td class="py-3 px-4">5,432</td>
                                    <td class="py-3 px-4">6,321</td>
                                    <td class="py-3 px-4">2:30</td>
                                    <td class="py-3 px-4">45.6%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Custom Reports Tab -->
            <section id="custom-reports" class="tab-content hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-medium mb-2">Custom Reports</h2>
                    <p class="text-gray-600">View and manage your saved custom reports</p>
                </div>
                
                <!-- Saved Reports List -->
                <div class="material-card p-4 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-medium">Saved Reports</h3>
                        <button id="newReportBtn" class="material-btn bg-primary text-white px-4 py-2 flex items-center">
                            <span class="material-icon mr-1">add</span>
                            New Report
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="min-w-full">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Report Name</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Created</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Last Modified</th>
                                    <th class="py-3 px-4 text-left text-sm font-medium text-gray-500">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">Weekly SEO Performance</td>
                                    <td class="py-3 px-4">2025-07-01</td>
                                    <td class="py-3 px-4">2025-07-08</td>
                                    <td class="py-3 px-4">
                                        <button class="p-1 rounded hover:bg-gray-200">
                                            <span class="material-icon">visibility</span>
                                        </button>
                                        <button class="p-1 rounded hover:bg-gray-200 ml-2">
                                            <span class="material-icon">edit</span>
                                        </button>
                                        <button class="p-1 rounded hover:bg-gray-200 ml-2">
                                            <span class="material-icon">delete</span>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">Monthly Traffic Analysis</td>
                                    <td class="py-3 px-4">2025-06-15</td>
                                    <td class="py-3 px-4">2025-07-05</td>
                                    <td class="py-3 px-4">
                                        <button class="p-1 rounded hover:bg-gray-200">
                                            <span class="material-icon">visibility</span>
                                        </button>
                                        <button class="p-1 rounded hover:bg-gray-200 ml-2">
                                            <span class="material-icon">edit</span>
                                        </button>
                                        <button class="p-1 rounded hover:bg-gray-200 ml-2">
                                            <span class="material-icon">delete</span>
                                        </button>
                                    </td>
                                </tr>
                                <tr class="border-b border-gray-100 hover:bg-gray-50">
                                    <td class="py-3 px-4">Keyword Tracking Report</td>
                                    <td class="py-3 px-4">2025-05-20</td>
                                    <td class="py-3 px-4">2025-07-10</td>
                                    <td class="py-3 px-4">
                                        <button class="p-1 rounded hover:bg-gray-200">
                                            <span class="material-icon">visibility</span>
                                        </button>
                                        <button class="p-1 rounded hover:bg-gray-200 ml-2">
                                            <span class="material-icon">edit</span>
                                        </button>
                                        <button class="p-1 rounded hover:bg-gray-200 ml-2">
                                            <span class="material-icon">delete</span>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Report Preview Area -->
                <div class="material-card p-4">
                    <h3 class="font-medium mb-4">Report Preview</h3>
                    <div class="border border-gray-200 rounded-lg p-4 h-96 overflow-y-auto">
                        <p class="text-center text-gray-600">Select a report to preview</p>
                    </div>
                </div>
            </section>

            <!-- Settings Tab -->
            <section id="settings" class="tab-content hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-medium mb-2">Settings</h2>
                    <p class="text-gray-600">Manage your account and integrations</p>
                </div>
                
                <!-- Account Settings -->
                <div class="material-card p-4 mb-6">
                    <h3 class="font-medium mb-4">Account Settings</h3>
                    <form>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" class="w-full border border-gray-300 rounded-lg p-2" value="user@example.com">
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                            <input type="password" class="w-full border border-gray-300 rounded-lg p-2" placeholder="********">
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Notification Preferences</label>
                            <select class="w-full border border-gray-300 rounded-lg p-2">
                                <option>Daily</option>
                                <option>Weekly</option>
                                <option>Monthly</option>
                                <option>None</option>
                            </select>
                        </div>
                        <button type="submit" class="material-btn bg-primary text-white px-4 py-2">Save Changes</button>
                    </form>
                </div>
                
                <!-- Integrations -->
                <div class="material-card p-4 mb-6">
                    <h3 class="font-medium mb-4">Integrations</h3>
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <span class="material-icon mr-2 text-green-500">check_circle</span>
                            <span>Google Search Console</span>
                        </div>
                        <button class="material-btn bg-white border border-gray-300 text-gray-700 px-4 py-1">Disconnect</button>
                    </div>
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <span class="material-icon mr-2 text-green-500">check_circle</span>
                            <span>Google Analytics</span>
                        </div>
                        <button class="material-btn bg-white border border-gray-300 text-gray-700 px-4 py-1">Disconnect</button>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="material-icon mr-2 text-red-500">cancel</span>
                            <span>HubSpot</span>
                        </div>
                        <button class="material-btn bg-primary text-white px-4 py-1">Connect</button>
                    </div>
                </div>
                
                <!-- Data Export -->
                <div class="material-card p-4">
                    <h3 class="font-medium mb-4">Data Export</h3>
                    <p class="text-gray-600 mb-4">Export all your data in CSV format</p>
                    <button class="material-btn bg-primary text-white px-4 py-2 flex items-center">
                        <span class="material-icon mr-1">download</span>
                        Export Data
                    </button>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Modal for Google API Connection -->
    <div id="apiModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg w-full max-w-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-medium">Connect Google API</h3>
                <button id="closeApiModal" class="p-1 rounded-full hover:bg-gray-200">
                    <span class="material-icon">close</span>
                </button>
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">Google Sheet URL</label>
                <input id="sheetUrl" type="text" class="w-full border border-gray-300 rounded-lg p-2" placeholder="https://docs.google.com/spreadsheets/d/...">
            </div>
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-1">API Key</label>
                <input id="apiKey" type="password" class="w-full border border-gray-300 rounded-lg p-2" placeholder="Enter your API key">
            </div>
            <div class="mb-4">
                <div class="flex items-center mb-2">
                    <input type="checkbox" id="searchConsole" class="mr-2" checked>
                    <label for="searchConsole">Google Search Console</label>
                </div>
                <div class="flex items-center">
                    <input type="checkbox" id="analytics" class="mr-2" checked>
                    <label for="analytics">Google Analytics</label>
                </div>
            </div>
            <div class="flex justify-end">
                <button id="cancelApiBtn" class="material-btn bg-gray-200 text-gray-700 px-4 py-2 mr-2">Cancel</button>
                <button id="connectApiBtn" class="material-btn bg-primary text-white px-4 py-2">Connect</button>
            </div>
        </div>
    </div>
    
    <!-- PDF Export Preview Modal -->
    <div id="pdfPreviewModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg w-full max-w-4xl p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-medium">PDF Export Preview</h3>
                <button id="closePdfModal" class="p-1 rounded-full hover:bg-gray-200">
                    <span class="material-icon">close</span>
                </button>
            </div>
            <div id="pdfPreviewContent" class="border border-gray-200 rounded-lg p-4 mb-4 h-96 overflow-y-auto">
                <div class="text-center p-8">
                    <h1 class="text-2xl font-bold mb-2">Analytics Report</h1>
                    <p class="text-gray-600 mb-4">Generated on July 11, 2025</p>
                    
                    <div class="mb-8">
                        <h2 class="text-xl font-medium mb-4 text-left">Traffic Overview</h2>
                        <div class="h-64 bg-gray-100 flex items-center justify-center">
                            <span class="material-icon text-6xl text-gray-400">insert_chart</span>
                        </div>
                    </div>
                    
                    <div class="mb-8">
                        <h2 class="text-xl font-medium mb-4 text-left">Top Pages</h2>
                        <div class="h-64 bg-gray-100 flex items-center justify-center">
                            <span class="material-icon text-6xl text-gray-400">bar_chart</span>
                        </div>
                    </div>
                    
                    <div>
                        <h2 class="text-xl font-medium mb-4 text-left">Keyword Rankings</h2>
                        <div class="h-64 bg-gray-100 flex items-center justify-center">
                            <span class="material-icon text-6xl text-gray-400">trending_up</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex justify-end">
                <button id="cancelPdfBtn" class="material-btn bg-gray-200 text-gray-700 px-4 py-2 mr-2">Cancel</button>
                <button id="downloadPdfBtn" class="material-btn bg-primary text-white px-4 py-2 flex items-center">
                    <span class="material-icon mr-1">download</span>
                    Download PDF
                </button>
            </div>
        </div>
    </div>

   <script>
    // Configuration
    const WEB_APP_URL = 'YOUR_WEB_APP_URL'; // Replace with your deployed Apps Script web app URL
    let currentDateRange = '7d';
    let analyticsData = {};
    let searchConsoleData = {};
    let sheetId = '';
    let propertyId = '';
    let siteUrl = '';

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
        // Load saved credentials
        sheetId = localStorage.getItem('sheetId') || '';
        propertyId = localStorage.getItem('propertyId') || '';
        siteUrl = localStorage.getItem('siteUrl') || '';
        if (sheetId && propertyId && siteUrl) {
            document.getElementById('sheetId').value = sheetId;
            document.getElementById('propertyId').value = propertyId;
            document.getElementById('siteUrl').value = siteUrl;
            loadDashboardData();
        }

        // Toggle side navigation
        const menuBtn = document.getElementById('menuBtn');
        const sideNav = document.getElementById('sideNav');
        menuBtn.addEventListener('click', function() {
            sideNav.classList.toggle('hidden');
        });

        // Account dropdown
        const accountDropdown = document.getElementById('accountDropdown');
        const accountDropdownContent = document.getElementById('accountDropdownContent');
        accountDropdown.addEventListener('click', function(event) {
            event.stopPropagation();
            accountDropdownContent.classList.toggle('show');
        });

        // Close dropdowns when clicking outside
        window.addEventListener('click', function(event) {
            if (!event.target.closest('.dropdown')) {
                const dropdowns = document.querySelectorAll('.dropdown-content.show');
                dropdowns.forEach(dropdown => dropdown.classList.remove('show'));
            }
        });

        // Chart dropdowns
        const chartDropdownBtns = document.querySelectorAll('.dropdown button .material-icon');
        chartDropdownBtns.forEach(btn => {
            if (btn.textContent === 'more_vert') {
                btn.parentElement.addEventListener('click', function(event) {
                    event.stopPropagation();
                    const content = this.nextElementSibling;
                    content.classList.toggle('show');
                });
            }
        });

        // API Connection Modal
        const connectSheetBtn = document.getElementById('connectSheetBtn');
        const apiModal = document.getElementById('apiModal');
        const closeApiModal = document.getElementById('closeApiModal');
        const cancelApiBtn = document.getElementById('cancelApiBtn');
        const connectApiBtn = document.getElementById('connectApiBtn');

        connectSheetBtn.addEventListener('click', function() {
            apiModal.classList.remove('hidden');
            apiModal.style.display = 'flex';
        });

        closeApiModal.addEventListener('click', closeApiModalFunction);
        cancelApiBtn.addEventListener('click', closeApiModalFunction);

        function closeApiModalFunction() {
            apiModal.classList.add('hidden');
            apiModal.style.display = 'none';
        }

        connectApiBtn.addEventListener('click', function() {
            sheetId = document.getElementById('sheetId').value;
            propertyId = document.getElementById('propertyId').value;
            siteUrl = document.getElementById('siteUrl').value;

            if (sheetId && propertyId && siteUrl) {
                localStorage.setItem('sheetId', sheetId);
                localStorage.setItem('propertyId', propertyId);
                localStorage.setItem('siteUrl', siteUrl);
                loadDashboardData();
                closeApiModalFunction();
            } else {
                alert('Please fill in all required fields.');
            }
        });

        // PDF Preview Modal
        const pdfPreviewModal = document.getElementById('pdfPreviewModal');
        const closePdfModal = document.getElementById('closePdfModal');
        const cancelPdfBtn = document.getElementById('cancelPdfBtn');
        const downloadPdfBtn = document.getElementById('downloadPdfBtn');
        const pdfPreviewContent = document.getElementById('pdfPreviewContent');

        function openPdfPreview() {
            const reportItems = document.querySelectorAll('#yourReport .report-item span:nth-child(2)');
            let previewHtml = `
                <h1 class="text-2xl font-bold mb-2">Analytics Report</h1>
                <p class="text-gray-600 mb-4">Generated on July 11, 2025</p>
            `;
            reportItems.forEach(item => {
                previewHtml += `
                    <div class="mb-8">
                        <h2 class="text-xl font-medium mb-4 text-left">${item.textContent}</h2>
                        <div class="h-64 bg-gray-100 flex items-center justify-center">
                            <span class="material-icon text-6xl text-gray-400">insert_chart</span>
                        </div>
                    </div>
                `;
            });
            pdfPreviewContent.innerHTML = previewHtml;
            pdfPreviewModal.classList.remove('hidden');
            pdfPreviewModal.style.display = 'flex';
        }

        document.getElementById('previewReportBtn').addEventListener('click', openPdfPreview);
        document.getElementById('exportReportBtn').addEventListener('click', openPdfPreview);
        document.getElementById('exportPdfBtn').addEventListener('click', openPdfPreview);

        closePdfModal.addEventListener('click', closePdfModalFunction);
        cancelPdfBtn.addEventListener('click', closePdfModalFunction);

        function closePdfModalFunction() {
            pdfPreviewModal.classList.add('hidden');
            pdfPreviewModal.style.display = 'none';
        }

        downloadPdfBtn.addEventListener('click', function() {
            console.log('Downloading PDF with content:', pdfPreviewContent.innerHTML);
            alert('PDF downloaded successfully!');
            closePdfModalFunction();
        });

        // Date range selector
        const dateChips = document.querySelectorAll('.chip');
        dateChips.forEach(chip => {
            chip.addEventListener('click', function() {
                dateChips.forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                currentDateRange = this.getAttribute('data-range');
                if (currentDateRange !== 'custom') {
                    loadDashboardData();
                }
            });
        });

        // Custom report builder
        const addChartButtons = document.querySelectorAll('.add-chart');
        addChartButtons.forEach(button => {
            button.addEventListener('click', function() {
                const chartItem = this.closest('.chart-item');
                const chartName = chartItem.querySelector('span:nth-child(2)').textContent;
                const chartIcon = chartItem.querySelector('.material-icon.text-primary').textContent;

                const reportContainer = document.getElementById('yourReport');
                const newChartItem = document.createElement('div');
                newChartItem.className = 'report-item flex items-center justify-between p-2 border-b border-gray-100 hover:bg-gray-50';
                newChartItem.innerHTML = `
                    <div class="flex items-center">
                        <span class="material-icon text-primary mr-2">${chartIcon}</span>
                        <span>${chartName}</span>
                    </div>
                    <div class="flex">
                        <button class="move-up p-1 rounded hover:bg-gray-200 mr-1">
                            <span class="material-icon">arrow_upward</span>
                        </button>
                        <button class="move-down p-1 rounded hover:bg-gray-200 mr-1">
                            <span class="material-icon">arrow_downward</span>
                        </button>
                        <button class="delete-chart p-1 rounded hover:bg-gray-200">
                            <span class="material-icon">delete</span>
                        </button>
                    </div>
                `;
                reportContainer.appendChild(newChartItem);
                attachReportItemListeners(newChartItem);
            });
        });

        function attachReportItemListeners(item) {
            const deleteBtn = item.querySelector('.delete-chart');
            deleteBtn.addEventListener('click', function() {
                item.remove();
            });

            const upBtn = item.querySelector('.move-up');
            upBtn.addEventListener('click', function() {
                const prev = item.previousElementSibling;
                if (prev) {
                    item.parentNode.insertBefore(item, prev);
                }
            });

            const downBtn = item.querySelector('.move-down');
            downBtn.addEventListener('click', function() {
                const next = item.nextElementSibling;
                if (next) {
                    item.parentNode.insertBefore(next, item);
                }
            });
        }

        const initialReportItems = document.querySelectorAll('#yourReport .report-item');
        initialReportItems.forEach(attachReportItemListeners);

        document.getElementById('saveReportBtn').addEventListener('click', function() {
            const reportItems = Array.from(document.querySelectorAll('#yourReport .report-item span:nth-child(2)')).map(span => span.textContent);
            console.log('Saving report with charts:', reportItems);
            alert('Report saved successfully!');
        });

        document.getElementById('addToReportBtn').addEventListener('click', function() {
            alert('Chart added to your custom report!');
        });

        // Navigation tab switching
        const navItems = document.querySelectorAll('.nav-item');
        const tabContents = document.querySelectorAll('.tab-content');
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                navItems.forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                    if (content.id === targetId) {
                        content.classList.remove('hidden');
                    }
                });
            });
        });

        // Custom Reports tab functionality
        const newReportBtn = document.getElementById('newReportBtn');
        if (newReportBtn) {
            newReportBtn.addEventListener('click', function() {
                alert('Creating new report...');
            });
        }

        const reportActions = document.querySelectorAll('#custom-reports table button');
        reportActions.forEach(btn => {
            btn.addEventListener('click', function() {
                const icon = this.querySelector('.material-icon').textContent;
                if (icon === 'visibility') {
                    document.getElementById('report-preview').innerHTML = `
                        <h1 class="text-2xl font-bold mb-2">Report Preview</h1>
                        <p class="text-gray-600 mb-4">Preview of ${this.closest('tr').querySelector('td').textContent}</p>
                        <div class="h-64 bg-gray-100 flex items-center justify-center">
                            <span class="material-icon text-6xl text-gray-400">insert_chart</span>
                        </div>
                    `;
                } else if (icon === 'edit') {
                    alert('Editing report...');
                } else if (icon === 'delete') {
                    if (confirm('Delete this report?')) {
                        this.closest('tr').remove();
                    }
                }
            });
        });

        // Settings form submit
        const settingsForm = document.querySelector('#settings form');
        if (settingsForm) {
            settingsForm.addEventListener('submit', function(e) {
                e.preventDefault();
                alert('Settings saved successfully!');
            });
        }

        // Integration buttons
        const integrationBtns = document.querySelectorAll('#settings .material-btn:not(#saveSettingsBtn)');
        integrationBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const action = this.textContent.trim();
                const integration = this.previousElementSibling.querySelector('span:nth-child(2)').textContent;
                alert(`${action}ing ${integration}...`);
            });
        });

        // Export buttons
        document.getElementById('export-search-console-btn').addEventListener('click', function() {
            exportToSheet('searchConsole', searchConsoleData);
        });

        document.getElementById('export-analytics-btn').addEventListener('click', function() {
            exportToSheet('analytics', analyticsData);
        });

        document.getElementById('export-all-btn').addEventListener('click', function() {
            exportToSheet('analytics', analyticsData);
            exportToSheet('searchConsole', searchConsoleData);
        });
    });

    // Fetch Dashboard Data
    async function loadDashboardData() {
        try {
            // Fetch Analytics Data
            const analyticsResponse = await fetch(WEB_APP_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'fetchAnalytics',
                    propertyId: propertyId,
                    dateRange: currentDateRange
                })
            });
            const analyticsResult = await analyticsResponse.json();
            if (analyticsResult.error) throw new Error(analyticsResult.error);
            analyticsData = analyticsResult;

            // Fetch Search Console Data
            const searchConsoleResponse = await fetch(WEB_APP_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'fetchSearchConsole',
                    siteUrl: siteUrl,
                    dateRange: currentDateRange
                })
            });
            const searchConsoleResult = await searchConsoleResponse.json();
            if (searchConsoleResult.error) throw new Error(searchConsoleResult.error);
            searchConsoleData = searchConsoleResult;

            updateDashboard();
            updateSearchConsoleTab();
            updateAnalyticsTab();
        } catch (error) {
            console.error('Error fetching data:', error);
            alert('Failed to fetch data: ' + error.message);
        }
    }

    // Export Data to Sheet
    async function exportToSheet(dataType, data) {
        try {
            const response = await fetch(WEB_APP_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    action: 'exportToSheet',
                    sheetId: sheetId,
                    dataType: dataType,
                    data: data
                })
            });
            const result = await response.json();
            if (result.error) throw new Error(result.error);
            alert(result.message);
        } catch (error) {
            console.error('Error exporting data:', error);
            alert('Failed to export data: ' + error.message);
        }
    }

    // Update Dashboard Tab
    function updateDashboard() {
        // Quick Stats
        const metrics = analyticsData.rows.reduce((acc, row) => {
            acc.users = (acc.users || 0) + parseInt(row.metricValues[0].value);
            acc.pageViews = (acc.pageViews || 0) + parseInt(row.metricValues[2].value);
            acc.sessionDuration = (acc.sessionDuration || 0) + parseFloat(row.metricValues[3].value);
            acc.engagementRate = (acc.engagementRate || 0) + parseFloat(row.metricValues[4].value);
            return acc;
        }, { users: 0, pageViews: 0, sessionDuration: 0, engagementRate: 0 });

        document.getElementById('total-users').textContent = metrics.users.toLocaleString();
        document.getElementById('page-views').textContent = metrics.pageViews.toLocaleString();
        document.getElementById('avg-session').textContent = formatDuration(metrics.sessionDuration / analyticsData.rows.length);
        document.getElementById('bounce-rate').textContent = ((1 - metrics.engagementRate / analyticsData.rows.length) * 100).toFixed(1) + '%';

        // Traffic Overview Chart
        const trafficData = analyticsData.rows.reduce((acc, row) => {
            const date = row.dimensionValues[0].value;
            acc[date] = acc[date] || { users: 0, pageViews: 0 };
            acc[date].users += parseInt(row.metricValues[0].value);
            acc[date].pageViews += parseInt(row.metricValues[2].value);
            return acc;
        }, {});
        updateTrafficOverviewChart(Object.keys(trafficData).sort().map(date => ({
            date,
            users: trafficData[date].users,
            pageViews: trafficData[date].pageViews
        })));

        // Top Pages Chart
        const topPages = analyticsData.rows.reduce((acc, row) => {
            const path = row.dimensionValues[1].value;
            acc[path] = (acc[path] || 0) + parseInt(row.metricValues[2].value);
            return acc;
        }, {});
        const sortedPages = Object.entries(topPages).map(([path, views]) => ({ path, views }))
            .sort((a, b) => b.views - a.views).slice(0, 5);
        updateTopPagesChart(sortedPages);

        // Search Console Table
        const scRows = searchConsoleData.rows.slice(0, 5).map(row => ({
            query: row.keys[0],
            clicks: row.clicks,
            impressions: row.impressions,
            ctr: (row.ctr * 100).toFixed(1) + '%',
            position: row.position.toFixed(1)
        }));
        updateSearchConsoleTable(scRows);
    }

    // Update Search Console Tab
    function updateSearchConsoleTab() {
        // Quick Stats
        const scMetrics = searchConsoleData.rows.reduce((acc, row) => {
            acc.clicks = (acc.clicks || 0) + row.clicks;
            acc.impressions = (acc.impressions || 0) + row.impressions;
            acc.ctr = (acc.ctr || 0) + row.ctr;
            acc.position = (acc.position || 0) + row.position;
            return acc;
        }, { clicks: 0, impressions: 0, ctr: 0, position: 0 });

        document.getElementById('total-clicks').textContent = scMetrics.clicks.toLocaleString();
        document.getElementById('total-impressions').textContent = scMetrics.impressions.toLocaleString();
        document.getElementById('avg-ctr').textContent = (scMetrics.ctr / searchConsoleData.rows.length * 100).toFixed(1) + '%';
        document.getElementById('avg-position').textContent = (scMetrics.position / searchConsoleData.rows.length).toFixed(1);

        // Clicks and Impressions Chart
        const scData = searchConsoleData.rows.reduce((acc, row) => {
            const date = row.keys[2];
            acc[date] = acc[date] || { clicks: 0, impressions: 0 };
            acc[date].clicks += row.clicks;
            acc[date].impressions += row.impressions;
            return acc;
        }, {});
        updateClicksImpressionsChart(Object.keys(scData).sort().map(date => ({
            date,
            clicks: scData[date].clicks,
            impressions: scData[date].impressions
        })));

        // Top Queries Chart
        const topQueries = searchConsoleData.rows.reduce((acc, row) => {
            const query = row.keys[0];
            acc[query] = (acc[query] || 0) + row.clicks;
            return acc;
        }, {});
        const sortedQueries = Object.entries(topQueries).map(([query, clicks]) => ({ query, clicks }))
            .sort((a, b) => b.clicks - a.clicks).slice(0, 5);
        updateTopQueriesChart(sortedQueries);

        // Detailed Query Table
        const detailedRows = searchConsoleData.rows.map(row => ({
            query: row.keys[0],
            clicks: row.clicks,
            impressions: row.impressions,
            ctr: (row.ctr * 100).toFixed(1) + '%',
            position: row.position.toFixed(1),
            page: row.keys[1]
        }));
        updateDetailedQueryTable(detailedRows);
    }

    // Update Analytics Tab
    function updateAnalyticsTab() {
        // Quick Stats
        const metrics = analyticsData.rows.reduce((acc, row) => {
            acc.activeUsers = (acc.activeUsers || 0) + parseInt(row.metricValues[0].value);
            acc.sessions = (acc.sessions || 0) + parseInt(row.metricValues[1].value);
            acc.engagementRate = (acc.engagementRate || 0) + parseFloat(row.metricValues[4].value);
            acc.newUsers = (acc.newUsers || 0) + parseInt(row.metricValues[0].value);
            return acc;
        }, { activeUsers: 0, sessions: 0, engagementRate: 0, newUsers: 0 });

        document.getElementById('active-users').textContent = metrics.activeUsers.toLocaleString();
        document.getElementById('sessions').textContent = metrics.sessions.toLocaleString();
        document.getElementById('engagement-rate').textContent = (metrics.engagementRate / analyticsData.rows.length * 100).toFixed(1) + '%';
        document.getElementById('new-users').textContent = metrics.newUsers.toLocaleString();

        // Users and Sessions Chart
        const userSessionData = analyticsData.rows.reduce((acc, row) => {
            const date = row.dimensionValues[0].value;
            acc[date] = acc[date] || { users: 0, sessions: 0 };
            acc[date].users += parseInt(row.metricValues[0].value);
            acc[date].sessions += parseInt(row.metricValues[1].value);
            return acc;
        }, {});
        updateUsersSessionsChart(Object.keys(userSessionData).sort().map(date => ({
            date,
            users: userSessionData[date].users,
            sessions: userSessionData[date].sessions
        })));

        // Traffic Sources Chart
        const trafficSources = analyticsData.rows.reduce((acc, row) => {
            const source = row.dimensionValues[2].value;
            acc[source] = (acc[source] || 0) + parseInt(row.metricValues[0].value);
            return acc;
        }, {});
        updateTrafficSourcesChart(Object.entries(trafficSources).map(([source, users]) => ({ source, users })));

        // User Behavior Table
        const behaviorRows = analyticsData.rows.reduce((acc, row) => {
            const path = row.dimensionValues[1].value;
            acc[path] = acc[path] || { users: 0, sessions: 0, duration: 0, engagement: 0, count: 0 };
            acc[path].users += parseInt(row.metricValues[0].value);
            acc[path].sessions += parseInt(row.metricValues[1].value);
            acc[path].duration += parseFloat(row.metricValues[3].value);
            acc[path].engagement += parseFloat(row.metricValues[4].value);
            acc[path].count += 1;
            return acc;
        }, {});
        updateUserBehaviorTable(Object.entries(behaviorRows).map(([path, data]) => ({
            path,
            users: data.users,
            sessions: data.sessions,
            avgTime: formatDuration(data.duration / data.count),
            bounceRate: ((1 - data.engagement / data.count) * 100).toFixed(1) + '%'
        })));
    }

    // Chart Update Functions
    function updateTrafficOverviewChart(data) {
        const svg = document.querySelector('#traffic-overview-chart svg');
        const maxValue = Math.max(...data.map(d => Math.max(d.users, d.pageViews)));
        const step = (750 - 100) / (data.length - 1);
        const userPoints = data.map((d, i) => {
            const y = 250 - (d.users / maxValue * 200);
            return `${100 + i * step},${y}`;
        });
        const pageViewPoints = data.map((d, i) => {
            const y = 250 - (d.pageViews / maxValue * 200);
            return `${100 + i * step},${y}`;
        });

        svg.innerHTML = `
            <!-- Grid Lines -->
            <line x1="50" y1="250" x2="750" y2="250" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="200" x2="750" y2="200" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="150" x2="750" y2="150" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="100" x2="750" y2="100" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="50" x2="750" y2="50" stroke="#E0E0E0" stroke-width="1" />
            <!-- Y-axis labels -->
            <text x="40" y="250" text-anchor="end" font-size="12" fill="#757575">0</text>
            <text x="40" y="200" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.25 / 1000).toFixed(0)}k</text>
            <text x="40" y="150" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.5 / 1000).toFixed(0)}k</text>
            <text x="40" y="100" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.75 / 1000).toFixed(0)}k</text>
            <text x="40" y="50" text-anchor="end" font-size="12" fill="#757575">${(maxValue / 1000).toFixed(0)}k</text>
            <!-- X-axis labels -->
            ${data.map((d, i) => `<text x="${100 + i * step}" y="270" text-anchor="middle" font-size="12" fill="#757575">${d.date.slice(5, 10)}</text>`).join('')}
            <!-- Line for Users -->
            <path d="M${userPoints.join(' L')}" fill="none" stroke="#6750A4" stroke-width="3" />
            <!-- Line for Page Views -->
            <path d="M${pageViewPoints.join(' L')}" fill="none" stroke="#B58392" stroke-width="3" />
            ${data.map((d, i) => `
                <circle cx="${100 + i * step}" cy="${250 - (d.users / maxValue * 200)}" r="5" fill="#6750A4" />
                <circle cx="${100 + i * step}" cy="${250 - (d.pageViews / maxValue * 200)}" r="5" fill="#B58392" />
            `).join('')}
        `;
    }

    function updateTopPagesChart(data) {
        const svg = document.querySelector('#top-pages-chart svg');
        const maxValue = Math.max(...data.map(d => d.views));
        const barHeight = 30;
        const spacing = 10;

        svg.innerHTML = data.map((d, i) => `
            <rect x="150" y="${40 + i * (barHeight + spacing)}" width="${(d.views / maxValue * 500)}" height="${barHeight}" fill="#6750A4" rx="4" ry="4" />
            <text x="140" y="${60 + i * (barHeight + spacing)}" text-anchor="end" font-size="12" fill="#757575">${d.path}</text>
            <text x="${150 + (d.views / maxValue * 500) + 10}" y="${60 + i * (barHeight + spacing)}" font-size="12" fill="#FFFFFF" font-weight="bold">${d.views.toLocaleString()}</text>
        `).join('');
    }

    function updateSearchConsoleTable(data) {
        const tbody = document.querySelector('#search-console-table tbody');
        tbody.innerHTML = data.length ? data.map(row => `
            <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4">${row.query}</td>
                <td class="py-3 px-4">${row.clicks.toLocaleString()}</td>
                <td class="py-3 px-4">${row.impressions.toLocaleString()}</td>
                <td class="py-3 px-4">${row.ctr}</td>
                <td class="py-3 px-4">${row.position}</td>
            </tr>
        `).join('') : '<tr><td colspan="5" class="py-3 px-4 text-center">No data available</td></tr>';
    }

    function updateClicksImpressionsChart(data) {
        const svg = document.querySelector('#clicks-impressions-chart svg');
        const maxValue = Math.max(...data.map(d => Math.max(d.clicks, d.impressions)));
        const step = (750 - 100) / (data.length - 1);
        const clickPoints = data.map((d, i) => {
            const y = 250 - (d.clicks / maxValue * 200);
            return `${100 + i * step},${y}`;
        });
        const impressionPoints = data.map((d, i) => {
            const y = 250 - (d.impressions / maxValue * 200);
            return `${100 + i * step},${y}`;
        });

        svg.innerHTML = `
            <line x1="50" y1="250" x2="750" y2="250" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="200" x2="750" y2="200" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="150" x2="750" y2="150" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="100" x2="750" y2="100" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="50" x2="750" y2="50" stroke="#E0E0E0" stroke-width="1" />
            <text x="40" y="250" text-anchor="end" font-size="12" fill="#757575">0</text>
            <text x="40" y="200" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.25 / 1000).toFixed(0)}k</text>
            <text x="40" y="150" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.5 / 1000).toFixed(0)}k</text>
            <text x="40" y="100" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.75 / 1000).toFixed(0)}k</text>
            <text x="40" y="50" text-anchor="end" font-size="12" fill="#757575">${(maxValue / 1000).toFixed(0)}k</text>
            ${data.map((d, i) => `<text x="${100 + i * step}" y="270" text-anchor="middle" font-size="12" fill="#757575">${d.date.slice(5, 10)}</text>`).join('')}
            <path d="M${clickPoints.join(' L')}" fill="none" stroke="#6750A4" stroke-width="3" />
            <path d="M${impressionPoints.join(' L')}" fill="none" stroke="#B58392" stroke-width="3" />
            ${data.map((d, i) => `
                <circle cx="${100 + i * step}" cy="${250 - (d.clicks / maxValue * 200)}" r="5" fill="#6750A4" />
                <circle cx="${100 + i * step}" cy="${250 - (d.impressions / maxValue * 200)}" r="5" fill="#B58392" />
            `).join('')}
        `;
    }

    function updateTopQueriesChart(data) {
        const svg = document.querySelector('#top-queries-chart svg');
        const maxValue = Math.max(...data.map(d => d.clicks));
        const barHeight = 30;
        const spacing = 10;

        svg.innerHTML = data.map((d, i) => `
            <rect x="150" y="${40 + i * (barHeight + spacing)}" width="${(d.clicks / maxValue * 500)}" height="${barHeight}" fill="#6750A4" rx="4" ry="4" />
            <text x="140" y="${60 + i * (barHeight + spacing)}" text-anchor="end" font-size="12" fill="#757575">${d.query}</text>
            <text x="${150 + (d.clicks / maxValue * 500) + 10}" y="${60 + i * (barHeight + spacing)}" font-size="12" fill="#FFFFFF" font-weight="bold">${d.clicks.toLocaleString()}</text>
        `).join('');
    }

    function updateDetailedQueryTable(data) {
        const tbody = document.querySelector('#detailed-query-table tbody');
        tbody.innerHTML = data.length ? data.map(row => `
            <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4">${row.query}</td>
                <td class="py-3 px-4">${row.clicks.toLocaleString()}</td>
                <td class="py-3 px-4">${row.impressions.toLocaleString()}</td>
                <td class="py-3 px-4">${row.ctr}</td>
                <td class="py-3 px-4">${row.position}</td>
                <td class="py-3 px-4">${row.page}</td>
            </tr>
        `).join('') : '<tr><td colspan="6" class="py-3 px-4 text-center">No data available</td></tr>';
    }

    function updateUsersSessionsChart(data) {
        const svg = document.querySelector('#users-sessions-chart svg');
        const maxValue = Math.max(...data.map(d => Math.max(d.users, d.sessions)));
        const step = (750 - 100) / (data.length - 1);
        const userPoints = data.map((d, i) => {
            const y = 250 - (d.users / maxValue * 200);
            return `${100 + i * step},${y}`;
        });
        const sessionPoints = data.map((d, i) => {
            const y = 250 - (d.sessions / maxValue * 200);
            return `${100 + i * step},${y}`;
        });

        svg.innerHTML = `
            <line x1="50" y1="250" x2="750" y2="250" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="200" x2="750" y2="200" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="150" x2="750" y2="150" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="100" x2="750" y2="100" stroke="#E0E0E0" stroke-width="1" />
            <line x1="50" y1="50" x2="750" y2="50" stroke="#E0E0E0" stroke-width="1" />
            <text x="40" y="250" text-anchor="end" font-size="12" fill="#757575">0</text>
            <text x="40" y="200" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.25 / 1000).toFixed(0)}k</text>
            <text x="40" y="150" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.5 / 1000).toFixed(0)}k</text>
            <text x="40" y="100" text-anchor="end" font-size="12" fill="#757575">${(maxValue * 0.75 / 1000).toFixed(0)}k</text>
            <text x="40" y="50" text-anchor="end" font-size="12" fill="#757575">${(maxValue / 1000).toFixed(0)}k</text>
            ${data.map((d, i) => `<text x="${100 + i * step}" y="270" text-anchor="middle" font-size="12" fill="#757575">${d.date.slice(5, 10)}</text>`).join('')}
            <path d="M${userPoints.join(' L')}" fill="none" stroke="#6750A4" stroke-width="3" />
            <path d="M${sessionPoints.join(' L')}" fill="none" stroke="#B58392" stroke-width="3" />
            ${data.map((d, i) => `
                <circle cx="${100 + i * step}" cy="${250 - (d.users / maxValue * 200)}" r="5" fill="#6750A4" />
                <circle cx="${100 + i * step}" cy="${250 - (d.sessions / maxValue * 200)}" r="5" fill="#B58392" />
            `).join('')}
        `;
    }

    function updateTrafficSourcesChart(data) {
        const svg = document.querySelector('#traffic-sources-chart svg');
        const total = data.reduce((sum, d) => sum + d.users, 0);
        let startAngle = 0;

        svg.innerHTML = data.map((d, i) => {
            const percentage = d.users / total;
            const endAngle = startAngle + percentage * 2 * Math.PI;
            const largeArc = percentage > 0.5 ? 1 : 0;
            const startX = 200 + 100 * Math.cos(startAngle);
            const startY = 150 + 100 * Math.sin(startAngle);
            const endX = 200 + 100 * Math.cos(endAngle);
            const endY = 150 + 100 * Math.sin(endAngle);
            const path = `M200,150 L${startX},${startY} A100,100 0 ${largeArc},1 ${endX},${endY} Z`;
            const labelX = 200 + 120 * Math.cos(startAngle + percentage * Math.PI);
            const labelY = 150 + 120 * Math.sin(startAngle + percentage * Math.PI);
            startAngle = endAngle;
            const colors = ['#6750A4', '#B58392', '#958DA5', '#34D399'];
            return `
                <path d="${path}" fill="${colors[i % colors.length]}" />
                <text x="${labelX}" y="${labelY}" font-size="12" fill="#757575">${d.source} ${(percentage * 100).toFixed(0)}%</text>
            `;
        }).join('');
    }

    function updateUserBehaviorTable(data) {
        const tbody = document.querySelector('#user-behavior-table tbody');
        tbody.innerHTML = data.length ? data.map(row => `
            <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4">${row.path}</td>
                <td class="py-3 px-4">${row.users.toLocaleString()}</td>
                <td class="py-3 px-4">${row.sessions.toLocaleString()}</td>
                <td class="py-3 px-4">${row.avgTime}</td>
                <td class="py-3 px-4">${row.bounceRate}</td>
            </tr>
        `).join('') : '<tr><td colspan="5" class="py-3 px-4 text-center">No data available</td></tr>';
    }

    function formatDuration(seconds) {
        const minutes = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
    }
</script>
</body>
</html>
